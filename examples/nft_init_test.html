<html>
<body>

<!-- <script src="js/third_party/three.js/three.min.js"></script> -->
<!-- <script src="../build/artoolkit.debug.js"></script> -->
<script src="../build/artoolkit.min.js"></script>
<script src="../js/artoolkit.api.js"></script>
<p id="count"></p>
<input type="file" id="videoFile" />
<video id="video" src="Data/IMG_3146.mov" width="640" height="360" controls="" autoplay></video>
<!-- <img id="v" src="Data/IMG_3141.JPG"></img> -->

<script>
var video = document.querySelector('#video');
var count = document.querySelector('#count');
var result = {};
//var ar = new ARController(video.videoWidth, video.videoHeight, 'Data/camera_para.dat');

function run_test(marker) {
  var ar = new ARController(video.width, video.height, 'Data/camera_para.dat');
  ar.onload = function() {
          var number = 0;
          count.textContent = number;

            ar.loadNFTMarker(marker, function(marker) {
              result[marker] = 0;
              console.log('loaded');
              console.log('markerID', marker);
            });

          ar.addEventListener('getNFTMarker', function(ev) {
            result[ev.data.marker.id]++;
            console.log('[saw]', ev.data.marker.id, 'result: ', result);
          });

          setInterval(function() {
                  ar.process(video);
          }, 33);
  };
  return ar;
}

var A = ['Pattern/1', 'Pattern/2',  'Pattern/3',  'Pattern/4',  'Pattern/5',  'Pattern/6',  'Pattern/7', 'Pattern/8'];

var ar = run_test(A.shift());

video.addEventListener('ended', function() {
  console.log('finished');
  //ar.dispose();
  pat = A.shift();
  console.log(pat);
  if(pat) {
    console.log('continue next test');
    ar = run_test(pat);
    video.play();
  }else{
    console.log('finished');
  }
});

</script>

</body>
</html>
